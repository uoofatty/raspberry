â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ 
â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ 
â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ 
â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ 
âš âš âš  æ³¨æ„äº‹é¡¹

âš¡ æ­å»ºç¯å¢ƒä¹‹å‰åº”æ›´æ–°èµ„æºåŒ…

sudo apt-get update
sudo apt-get upgrade

âš¡ å®‰è£…vim ç¼–è¾‘å™¨ -- è¿æ¥å¤±è´¥é—®é¢˜ï¼Œå¯ä¿®æ”¹æºä¸ºæ¸…åæºï¼šhttps://mirror.tuna.tsinghua.edu.cn/help/raspbian/

sudo nano /etc/apt/sources.list

åˆ é™¤åŸæ–‡ä»¶æ‰€æœ‰å†…å®¹ï¼Œç”¨ä»¥ä¸‹å†…å®¹å–ä»£ï¼š

deb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ stretch main non-free contrib
deb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ stretch main non-free contrib

å³å¯è§£å†³ã€‚

âš¡ ç¡®ä¿æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ v2ray ç‰ˆæœ¬å…¼å®¹æ€§ã€‚

âš¡ å¦‚æ“ä½œå®Œæˆåï¼Œå†…ç½‘å¯è¿æ¥ï¼Œå¤–ç½‘è¿æ¥å¤±è´¥ï¼Œå¼€é€‰æ‹©ä¿®æ”¹v2rayé…ç½®æ–‡ä»¶loglevelä¸ºdebugï¼Œæ¥æ’æŸ¥é”™è¯¯ã€‚

â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ 
â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ 
â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ 
â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ 

ä¸€ã€åˆ»å½•é•œåƒå®Œæˆåï¼Œå¼€å¯sshæœåŠ¡ã€‚

ğŸ’¡ ä¿®æ”¹é…ç½®æ–‡ä»¶

sudo  vim /etc/ssh/sshd_config

æ‰¾åˆ°PermitRootLogin ä¸€è¡Œï¼Œæ”¹ä¸ºPermitRootLogin yesï¼Œå³å…è®¸rootç”¨æˆ·ä»¥ä»»ä½•è®¤è¯æ–¹å¼ç™»å½•

ğŸ’¡ é‡å¯sshæœåŠ¡ 

sudo /etc/init.d/ssh restart

ğŸ’¡ è®¾ç½®sshå¼€æœºè‡ªåŠ¨å¯åŠ¨ enableå¼€å¯(disabledå…³é—­)

sudo update-rc.d ssh enable(disabled)

*****************************************************************************************************

äºŒã€é…ç½®hostsæ–‡ä»¶

sudo vim /etc/hosts

ğŸ’¡ æ·»åŠ å¦‚ä¸‹å†…å®¹åˆ°æ–‡ä»¶æœ«ç«¯å¹¶ä¿å­˜

127.0.1.1       raspberrypi 
00.00.00.00ï¼ˆæœåŠ¡å™¨åœ°å€ï¼‰    xxx.com.xxx.comï¼ˆæœåŠ¡å™¨åˆ«åï¼‰

*****************************************************************************************************

ä¸‰ã€ç½‘å¡é…ç½® wlan0é…ç½®ä¸€ä¸ªé™æ€IP

ğŸ’¡ ä¿®æ”¹é…ç½®æ–‡ä»¶interfaces

sudo vim /etc/network/interfaces

ä¿®æ”¹å¦‚ä¸‹ï¼š

auto eth0
iface eth0 inet dhcp

auto wlan0
iface wlan0 inet static
        address 192.168.220.1 
        netmask 255.255.255.0
        gateway 192.168.220.1

*****************************************************************************************************

å››ã€å®‰è£…hostapdï¼Œå¹¶æ–°å¢é…ç½®æ–‡ä»¶/etc/hostapd/hostapd.conf

ğŸ’¡ æ–°å¢æŒ‡å®šè·¯å¾„é…ç½®æ–‡ä»¶ï¼Œå¹¶æ·»åŠ æƒé™

sudo mkdir /etc/hostapd

sudo touch  /etc/hostapd/hostapd.conf

sudo chmod -R 777 /etc/hostapd/hostapd.conf

ğŸ’¡ ä¿®æ”¹é…ç½®æ–‡ä»¶hostapd.conf

sudo vim /etc/hostapd/hostapd.conf

ä¿®æ”¹å¦‚ä¸‹ï¼š

interface=wlan0

driver=nl80211

ssid=æ— çº¿åç§°

hw_mode=g

channel=11

ieee80211n=1

macaddr_acl=0

auth_algs=1

ignore_broadcast_ssid=0

wpa=2

wpa_key_mgmt=WPA-PSK

wpa_passphrase=æ— çº¿å¯†ç 

rsn_pairwise=TKIP CCMP

ğŸ‘ğŸ‘ğŸ‘ å¯æµ‹è¯•ä¸€ä¸‹è¿é€šæ€§

sudo /usr/sbin/hostapd /etc/hostapd/hostapd.conf

ï¼ˆç°åœ¨ä½ å¯ä»¥åœ¨æ‰‹æœºä¸Šæœåˆ°Pi3-APçš„wifiï¼Œè¾“å…¥å¯†ç è¿æ¥ä¸Šä¹‹åä¼šå‘ç°ä¸€ç›´ç­‰å¾…çš„çŠ¶æ€,
å› ä¸ºDHCPæœåŠ¡è¿˜æ²¡é…ç½®ï¼Œæˆ‘ä»¬ä¸‹ä¸€æ­¥å°±è¦é…ç½®dnsmasqã€‚ï¼‰

ğŸ’¡ å®‰è£…hostapd

sudo apt-get install hostapd

ğŸ’¡ å®‰è£…hostapdä¹‹åï¼Œç³»ç»ŸæœåŠ¡å·²ç»æ·»åŠ äº†ï¼Œä½†æ˜¯é…ç½®æ–‡ä»¶çš„åœ°å€è¿˜éœ€é…ç½®ï¼ˆæŒ‡å‘ä¸Šé¢è‡ªå®šä¹‰çš„é…ç½®æ–‡ä»¶ï¼‰ä¿®æ”¹hostapdé…ç½®æ–‡ä»¶

sudo vim /etc/default/hostapd

ä¿®æ”¹ä¸ºï¼š

DAEMON_CONF="/etc/hostapd/hostapd.conf"

*****************************************************************************************************

äº”ã€å®‰è£…dnsmasq

sudo apt-get install dnsmasq

ğŸ’¡ ä¿®æ”¹é…ç½®æ–‡ä»¶dnsmasq.conf

sudo vim /etc/dnsmasq.conf

ä¿®æ”¹ä¸ºï¼š

interface=wlan0

listen-address=192.168.220.1

no-dhcp-interface=lo,eth0

bind-interfaces

dhcp-range=192.168.220.50,192.168.220.150,72h

*****************************************************************************************************

å…­ã€å®‰è£…iptables

sudo apt-get install iptables

ğŸ’¡ ä¿®æ”¹é…ç½®æ–‡ä»¶sysctl.conf

sudo vim /etc/sysctl.conf

ä¿®æ”¹ä¸ºï¼š

net.ipv4.ip_forward=1

ğŸ’¡ ä¿å­˜é€€å‡ºå,é…ç½®ç«‹å³ç”Ÿæ•ˆã€‚

sudo sysctl -p

ğŸ’¡ é…ç½®nat

sudo iptables -t nat -N V2RAY
sudo iptables -t nat -A V2RAY -d 192.168.0.0/16 -j RETURN
sudo iptables -t nat -A V2RAY -p tcp -j REDIRECT --to-ports 12345
sudo iptables -t nat -A PREROUTING -p tcp -j V2RAY

ğŸ’¡ æ¯æ¬¡é‡å¯ä¹‹åiptablesçš„é…ç½®éƒ½ä¼šä¸¢å¤±ï¼Œæ‰€ä»¥éœ€è¦ä¿å­˜ä¸€ä¸‹

sudo sh -c "iptables-save > /etc/iptables.ipv4.nat"

ğŸ’¡ å¯ä»¥æŠŠrestoreæ­¥éª¤æ”¾åˆ°/etc/rc.localï¼Œæ¯æ¬¡é‡å¯éƒ½ä¼šè‡ªåŠ¨restore

sudo iptables-restore < /etc/iptables.ipv4.nat

ğŸ’¡ å¯åŠ¨æœåŠ¡

sudo service hostapd start 
sudo service dnsmasq start

ğŸ’¡ é…ç½®å®Œæˆåé‡å¯

sudo reboot

â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ 

https://python.freelycode.com/contribution/detail/336

â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ 

*****************************************************************************************************

ä¸ƒã€å®‰è£…v2ray, è¿™é‡Œé€‰æ‹©äº†è„šæœ¬å®‰è£…ï¼Œä¹Ÿå¯æ‰‹åŠ¨å®‰è£…

sudo su

bash <(curl -L -s https://install.direct/go.sh)

ğŸ’¡ ç¼–è¾‘é…ç½®æ–‡ä»¶ config.json

sudo vim /etc/v2ray/config.json

 ğŸ’¡ å¯åŠ¨ V2Ray è¿›ç¨‹
 
service v2ray start

(ä¹‹åå¯ä»¥ä½¿ç”¨ service v2ray start|stop|status|reload|restart|force-reload æ§åˆ¶ V2Ray çš„è¿è¡Œ)

â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ â†“ 

https://www.v2ray.com/chapter_02/01_overview.html
https://toutyrater.github.io/prep/json.html

â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ â†‘ 

****************************************************************************************************







